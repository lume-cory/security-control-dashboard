import { getRelativeDate } from "@/app/utils/date-utils";

// Security Tool Types
export type SecurityToolType = 
  'RAPID7' | 
  'TENABLE' | 
  'CROWDSTRIKE EDR' | 
  'CROWDSTRIKE FALCON' | 
  'QUALYS' | 
  'CREDO AI' | 
  'PROTECT AI' | 
  'ZAFRAN' | 
  'SNYK' | 
  'BLACKDUCK' | 
  'GITLAB' | 
  'GITHUB' | 
  'COVERITY' | 
  'VERACODE' | 
  'AWS_INSPECTOR' | 
  'AZURE_DEFENDER' | 
  'GCP_SECURITY';

// Vulnerability Severity
export type VulnerabilitySeverity = 'CRITICAL' | 'HIGH' | 'MEDIUM' | 'LOW';

// Vulnerability Status
export type VulnerabilityStatus = 'OPEN' | 'IN_REVIEW' | 'IN_PROGRESS' | 'NOT_APPLICABLE' | 'FIXED' | 'ACCEPTED_RISK';

// Team Ownership
export type TeamOwnership = 'SECURITY' | 'SECURITY OPERATIONS' | 'IT' | 'NETWORK SECURITY' | 'DEVOPS' | 'MOBILE ENGINEERING' | 'PLATFORM ENGINEERING' | 'AI PLATFORM ENGINEERING' | 'FRONTEND ENGINEERING' | 'BACKEND ENGINEERING' | 'DATA ENGINEERING' | 'PRODUCT MANAGEMENT' | 'CUSTOMER SUCCESS' | 'SALES' | 'MARKETING' | 'HR' | 'LEGAL' | 'OTHER';

// Tool Output Location
export interface ToolOutputLocation {
  repository: string;
  filePath?: string;
  lineNumber?: number;
  codeSnippet?: string;
  resourceId?: string;
  cloudProvider?: 'AWS' | 'AZURE' | 'GCP' | 'OTHER';
  region?: string;
}

// Tool Output
export interface ToolOutput {
  toolName: SecurityToolType;
  summary: string;
  vulnerabilityType: string;
  location?: ToolOutputLocation;
  recommendation?: string;
  detectionDate: string;
  rawOutput?: string;
  cvssScore?: number;
  exploitability?: 'EASY' | 'MODERATE' | 'DIFFICULT' | 'UNKNOWN';
  cveRefs?: {
    id: string;
    summary: string;
    link: string;
    cvssScore: number;
    cvssVector: string;
    publishedDate: string;
  }[];
}

// CVE Information
export interface CVEInfo {
  id: string;
  name: string;
  summary: string;
  publishDate: string;
  cvssScore: number;
  cvssSeverity: VulnerabilitySeverity;
  cvssVector: string;
  impactedSystems: Array<{
    name: string;
    version: string;
    library: 'npm' | 'maven' | 'pypi' | 'nuget' | 'gem' | 'os' | 'other';
    fixedInVersion?: string;
  }>;
  references?: string[];
  exploitAvailable?: boolean;
  exploitInTheWild?: boolean;
}

// OWASP Information
export interface OWASPInfo {
  id: string;
  name: string;
  description: string;
  exampleAttacks: string[];
  mitigations: string[];
  link: string;
}

// System Applicability
export interface SystemApplicability {
  systemName: string;
  isApplicable: boolean;
  reason: string;
  affectedComponents?: string[];
  mitigatingControls?: string[];
  buildFlags?: string[];
  vulnerableVersion?: string;
  ourVersion?: string;
  environment?: 'development' | 'staging' | 'production';
  isAffected?: boolean;
}

// Applicability Assessment
export interface ApplicabilityAssessment {
  isApplicable: boolean;
  justification?: string;
  assessedBy?: string;
  assessedDate?: string;
  systemAnalysis: SystemApplicability[];
}

// Compliance Impact
export interface ComplianceImpact {
  auditRisk: 'HIGH' | 'MEDIUM' | 'LOW';
  nextAuditDate: string;
  primaryFramework: string;
  controlIds: string[];
  nextSteps: {
    technical: Array<{
      step: string;
      aiAction?: string;  // Add AI follow-up action text
    }>;
    process: Array<{
      step: string;
      aiAction?: string;
    }>;
    documentation: Array<{
      step: string;
      aiAction?: string;
    }>;
    timeline: string;
    owner: string;
  };
}

// Remediation Details
export interface RemediationDetails {
  jiraTicket?: {
    id: string;
    url: string;
    status: string;
  };
  pullRequest?: {
    id: string;
    url: string;
    status: string;
  };
  patchAvailable?: boolean;
  patchLink?: string;
  workaroundAvailable?: boolean;
  estimatedEffort?: 'LOW' | 'MEDIUM' | 'HIGH';
  assignedTo?: string;
  targetFixDate?: string;
}

// Add new interfaces for asset details
interface AffectedAsset {
  name: string;
  resourceType: 'VM' | 'Container' | 'Database' | 'Storage' | 'Function' | 'API' | 'LoadBalancer' | 'Other';
  details: string;
  region: string;
  owner: string;
  team: TeamOwnership;
  platform: {
    os?: string;
    version?: string;
    type: 'Linux' | 'Windows' | 'MacOS' | 'Container' | 'Serverless' | 'Other';
  };
  tags?: Record<string, string>;
}

// Update ExposureDetails interface
export interface ExposureDetails {
  exposedAssets: number;
  affectedAssets: AffectedAsset[];
  exposedData?: string[];
  attackVector: string;
  attackComplexity: 'LOW' | 'MEDIUM' | 'HIGH';
  privilegesRequired: 'NONE' | 'LOW' | 'HIGH';
  userInteraction: 'NONE' | 'REQUIRED';
  scope: 'UNCHANGED' | 'CHANGED';
  confidentialityImpact: 'NONE' | 'LOW' | 'HIGH';
  integrityImpact: 'NONE' | 'LOW' | 'HIGH';
  availabilityImpact: 'NONE' | 'LOW' | 'HIGH';
}

// Main Vulnerability Interface
export interface Vulnerability {
  id: string;
  title: string;
  description: string;
  severity: VulnerabilitySeverity;
  status: VulnerabilityStatus;
  dateIdentified: string;
  dateUpdated: string;
  
  // Source Information
  sourceTools: SecurityToolType[];
  cveData?: CVEInfo[];
  owaspCategories?: OWASPInfo[];
  
  // Technical Details
  affectedRepository: string;
  teamOwner: TeamOwnership;
  affectedComponent: string;
  affectedVersion: string;
  buildFlags?: string[];
  
  // Assessment
  applicabilityAssessment: ApplicabilityAssessment;
  
  // Impact Analysis
  impactedPolicies: string[]; // References to CompliancePolicy ids
  remediationPlan?: string;
  workaround?: string;
  toolOutputs: ToolOutput[];
  complianceImpact: ComplianceImpact;
  remediationDetails: RemediationDetails;
  exposureDetails?: ExposureDetails;
  
  // Business Impact
  businessImpact?: {
    financial: string[];
    regulatory: string[];
    operational: string[];
    customer: string[];
  };
}

// Security Tool Interface
export interface SecurityTool {
  id: string;
  name: string;
  type: SecurityToolType;
  description: string;
  lastScanDate: string;
  nextScanDate: string;
  scanFrequency: 'DAILY' | 'WEEKLY' | 'MONTHLY' | 'QUARTERLY';
  coverage: {
    assetTypes: string[];
    environments: string[];
    technologies: string[];
  };
  integrations: string[];
  owner: string;
  status: 'ACTIVE' | 'INACTIVE' | 'MAINTENANCE';
  findings: {
    critical: number;
    high: number;
    medium: number;
    low: number;
    total: number;
  };
}

// Compliance Framework
export interface ComplianceFramework {
  id: string;
  name: string;
  description: string;
  version: string;
  category: 'REGULATORY' | 'INDUSTRY' | 'INTERNAL';
  applicability: string[];
  owner: string;
  lastAssessmentDate?: string;
  nextAssessmentDate?: string;
  status: 'COMPLIANT' | 'NON_COMPLIANT' | 'PARTIALLY_COMPLIANT' | 'UNDER_ASSESSMENT';
  controls: number;
  controlsMet: number;
}

// Compliance Policy
export interface CompliancePolicy {
  id: string;
  name: string;
  policyCode: string;
  policyText: string;
  policyLink: string;
  owner: string;
  lastReviewDate: string;
  nextReviewDate: string;
  status: 'ACTIVE' | 'UNDER_REVIEW' | 'DEPRECATED';
  frameworks: Array<{
    id: string;
    controlIds: string[];
  }>;
  businessImpact: {
    description: string;
    severity: 'LOW' | 'MEDIUM' | 'HIGH' | 'CRITICAL';
    financial: string[];
    operational: string[];
    regulatory: string[];
  };
}

// Sample Security Tools Data
export const securityTools: SecurityTool[] = [
  {
    id: 'TOOL-001',
    name: 'Rapid7 InsightVM',
    type: 'RAPID7',
    description: 'Vulnerability management and assessment platform',
    lastScanDate: getRelativeDate(-1),
    nextScanDate: getRelativeDate(6),
    scanFrequency: 'WEEKLY',
    coverage: {
      assetTypes: ['Servers', 'Workstations', 'Network Devices', 'Cloud Infrastructure'],
      environments: ['Production', 'Staging', 'Development'],
      technologies: ['Windows', 'Linux', 'AWS', 'Azure', 'Kubernetes']
    },
    integrations: ['JIRA', 'Slack', 'ServiceNow'],
    owner: 'Security Operations Team',
    status: 'ACTIVE',
    findings: {
      critical: 3,
      high: 12,
      medium: 45,
      low: 78,
      total: 138
    }
  },
  {
    id: 'TOOL-002',
    name: 'Tenable.io',
    type: 'TENABLE',
    description: 'Cloud-based vulnerability management platform',
    lastScanDate: getRelativeDate(-2),
    nextScanDate: getRelativeDate(5),
    scanFrequency: 'WEEKLY',
    coverage: {
      assetTypes: ['Servers', 'Containers', 'Cloud Infrastructure', 'Web Applications'],
      environments: ['Production', 'Staging'],
      technologies: ['Windows', 'Linux', 'Docker', 'Kubernetes', 'AWS', 'Azure']
    },
    integrations: ['JIRA', 'ServiceNow', 'GitHub'],
    owner: 'Security Operations Team',
    status: 'ACTIVE',
    findings: {
      critical: 2,
      high: 8,
      medium: 37,
      low: 65,
      total: 112
    }
  },
  {
    id: 'TOOL-003',
    name: 'CrowdStrike Falcon',
    type: 'CROWDSTRIKE FALCON',
    description: 'Endpoint protection and threat intelligence platform',
    lastScanDate: getRelativeDate(-1),
    nextScanDate: getRelativeDate(0), // Daily scan
    scanFrequency: 'DAILY',
    coverage: {
      assetTypes: ['Workstations', 'Servers', 'Mobile Devices'],
      environments: ['Production', 'Corporate'],
      technologies: ['Windows', 'macOS', 'Linux', 'iOS', 'Android']
    },
    integrations: ['SIEM', 'ServiceNow', 'Splunk'],
    owner: 'Security Operations Team',
    status: 'ACTIVE',
    findings: {
      critical: 1,
      high: 5,
      medium: 12,
      low: 23,
      total: 41
    }
  },
  {
    id: 'TOOL-004',
    name: 'Qualys VMDR',
    type: 'QUALYS',
    description: 'Vulnerability Management, Detection and Response',
    lastScanDate: getRelativeDate(-3),
    nextScanDate: getRelativeDate(4),
    scanFrequency: 'WEEKLY',
    coverage: {
      assetTypes: ['Servers', 'Workstations', 'Cloud Infrastructure', 'Containers'],
      environments: ['Production', 'Staging', 'Development'],
      technologies: ['Windows', 'Linux', 'AWS', 'Azure', 'GCP', 'Docker']
    },
    integrations: ['JIRA', 'ServiceNow', 'Slack'],
    owner: 'Security Operations Team',
    status: 'ACTIVE',
    findings: {
      critical: 4,
      high: 15,
      medium: 52,
      low: 87,
      total: 158
    }
  },
  {
    id: 'TOOL-005',
    name: 'Snyk',
    type: 'SNYK',
    description: 'Developer security platform for code and dependencies',
    lastScanDate: getRelativeDate(-1),
    nextScanDate: getRelativeDate(0), // Daily scan
    scanFrequency: 'DAILY',
    coverage: {
      assetTypes: ['Application Code', 'Dependencies', 'Containers', 'Infrastructure as Code'],
      environments: ['Development', 'CI/CD'],
      technologies: ['JavaScript', 'Python', 'Java', 'Go', 'Ruby', 'PHP', 'Docker', 'Kubernetes', 'Terraform']
    },
    integrations: ['GitHub', 'GitLab', 'Bitbucket', 'JIRA', 'Jenkins', 'CircleCI'],
    owner: 'Application Security Team',
    status: 'ACTIVE',
    findings: {
      critical: 2,
      high: 7,
      medium: 23,
      low: 45,
      total: 77
    }
  },
  {
    id: 'TOOL-006',
    name: 'Zafran.io',
    type: 'ZAFRAN',
    description: 'Attack surface management and external vulnerability scanning',
    lastScanDate: getRelativeDate(-2),
    nextScanDate: getRelativeDate(5),
    scanFrequency: 'WEEKLY',
    coverage: {
      assetTypes: ['External Web Applications', 'APIs', 'Cloud Resources', 'Domains'],
      environments: ['Production', 'External'],
      technologies: ['Web Servers', 'Cloud Services', 'DNS', 'SSL/TLS']
    },
    integrations: ['JIRA', 'Slack', 'Microsoft Teams'],
    owner: 'Security Operations Team',
    status: 'ACTIVE',
    findings: {
      critical: 1,
      high: 6,
      medium: 18,
      low: 32,
      total: 57
    }
  }, 
  {
    id: 'TOOL-007',
    name: 'CrowdStrike EDR',
    type: 'CROWDSTRIKE EDR',
    description: 'Endpoint protection and threat intelligence platform',
    lastScanDate: getRelativeDate(-1),
    nextScanDate: getRelativeDate(0), // Daily scan
    scanFrequency: 'DAILY',
    coverage: {
      assetTypes: ['Workstations', 'Servers', 'Mobile Devices'],
      environments: ['Production', 'Corporate'],
      technologies: ['Windows', 'macOS', 'Linux', 'iOS', 'Android']
    },
    integrations: ['SIEM', 'ServiceNow', 'Splunk'],
    owner: 'Security Operations Team',
    status: 'ACTIVE',
    findings: {
      critical: 1,
      high: 5,
      medium: 12,
      low: 23,
      total: 41
    }
  },
  {
    id: 'TOOL-008',
    name: 'Credo AI',
    type: 'CREDO AI',
    description: 'AI governance and risk management platform',
    lastScanDate: getRelativeDate(-1),
    nextScanDate: getRelativeDate(6),
    scanFrequency: 'WEEKLY',
    coverage: {
      assetTypes: ['AI Models', 'Training Data', 'Model Endpoints', 'Model Artifacts'],
      environments: ['Production', 'Staging', 'Development'],
      technologies: ['TensorFlow', 'PyTorch', 'Scikit-learn', 'Hugging Face', 'Custom Models']
    },
    integrations: ['GitHub', 'GitLab', 'MLflow', 'Weights & Biases', 'JIRA'],
    owner: 'AI Platform Team',
    status: 'ACTIVE',
    findings: {
      critical: 2,
      high: 8,
      medium: 15,
      low: 23,
      total: 48
    }
  },
  {
    id: 'TOOL-009',
    name: 'Protect AI',
    type: 'PROTECT AI',
    description: 'AI/ML security and vulnerability scanning platform',
    lastScanDate: getRelativeDate(-1),
    nextScanDate: getRelativeDate(0), // Daily scan
    scanFrequency: 'DAILY',
    coverage: {
      assetTypes: ['Model APIs', 'Model Servers', 'Training Pipelines', 'Model Registry'],
      environments: ['Production', 'Staging'],
      technologies: ['TensorFlow Serving', 'Triton', 'TorchServe', 'SageMaker', 'Vertex AI']
    },
    integrations: ['JIRA', 'Slack', 'PagerDuty', 'ServiceNow'],
    owner: 'AI Platform Security Team',
    status: 'ACTIVE',
    findings: {
      critical: 1,
      high: 6,
      medium: 12,
      low: 18,
      total: 37
    }
  }
];

// Sample Compliance Frameworks
export const complianceFrameworks: ComplianceFramework[] = [
  {
    id: 'FW-001',
    name: 'SOC 2',
    description: 'Service Organization Control 2',
    version: 'Type II',
    category: 'INDUSTRY',
    applicability: ['Cloud Services', 'SaaS Providers'],
    owner: 'Compliance Team',
    lastAssessmentDate: getRelativeDate(-90),
    nextAssessmentDate: getRelativeDate(275),
    status: 'COMPLIANT',
    controls: 116,
    controlsMet: 112
  },
  {
    id: 'FW-002',
    name: 'PCI-DSS',
    description: 'Payment Card Industry Data Security Standard',
    version: '4.0',
    category: 'INDUSTRY',
    applicability: ['Payment Processing', 'Cardholder Data Environment'],
    owner: 'Compliance Team',
    lastAssessmentDate: getRelativeDate(-120),
    nextAssessmentDate: getRelativeDate(245),
    status: 'PARTIALLY_COMPLIANT',
    controls: 78,
    controlsMet: 72
  },
  {
    id: 'FW-003',
    name: 'HIPAA',
    description: 'Health Insurance Portability and Accountability Act',
    version: '2023',
    category: 'REGULATORY',
    applicability: ['Healthcare Data', 'Patient Information'],
    owner: 'Compliance Team',
    lastAssessmentDate: getRelativeDate(-150),
    nextAssessmentDate: getRelativeDate(215),
    status: 'COMPLIANT',
    controls: 54,
    controlsMet: 54
  },
  {
    id: 'FW-004',
    name: 'ISO 27001',
    description: 'Information Security Management System',
    version: '2022',
    category: 'INDUSTRY',
    applicability: ['All Systems', 'Information Assets'],
    owner: 'Compliance Team',
    lastAssessmentDate: getRelativeDate(-180),
    nextAssessmentDate: getRelativeDate(185),
    status: 'UNDER_ASSESSMENT',
    controls: 114,
    controlsMet: 98
  },
  {
    id: 'FW-005',
    name: 'GDPR',
    description: 'General Data Protection Regulation',
    version: '2018',
    category: 'REGULATORY',
    applicability: ['Personal Data', 'EU Citizen Data'],
    owner: 'Privacy Team',
    lastAssessmentDate: getRelativeDate(-210),
    nextAssessmentDate: getRelativeDate(155),
    status: 'COMPLIANT',
    controls: 87,
    controlsMet: 85
  },
  {
    id: 'FW-006',
    name: 'NIST CSF',
    description: 'National Institute of Standards and Technology Cybersecurity Framework',
    version: '1.1',
    category: 'INDUSTRY',
    applicability: ['Critical Infrastructure', 'All Systems'],
    owner: 'Security Team',
    lastAssessmentDate: getRelativeDate(-240),
    nextAssessmentDate: getRelativeDate(125),
    status: 'PARTIALLY_COMPLIANT',
    controls: 108,
    controlsMet: 92
  }
];

// Sample Compliance Policies
export const compliancePolicies: CompliancePolicy[] = [
  {
    id: 'APP-001',
    name: 'Application Security Policy',
    policyCode: 'SEC-APP-001',
    policyText: 'All applications must undergo security testing before deployment to production. This includes static code analysis, dynamic testing, and dependency scanning.',
    policyLink: 'https://docs.company.com/policies/application-security',
    owner: 'Application Security Team',
    lastReviewDate: getRelativeDate(-60),
    nextReviewDate: getRelativeDate(305),
    status: 'ACTIVE',
    frameworks: [
      { id: 'FW-001', controlIds: ['CC7.1', 'CC7.2'] },
      { id: 'FW-002', controlIds: ['Requirement 6.5', 'Requirement 6.6'] },
      { id: 'FW-004', controlIds: ['A.14.2.1', 'A.14.2.5'] }
    ],
    businessImpact: {
      description: 'Ensures applications are secure before deployment, preventing potential data breaches and compliance violations.',
      severity: 'HIGH',
      financial: [],
      operational: [],
      regulatory: []
    }
  },
  {
    id: 'APP-009',
    name: 'API Security Policy',
    policyCode: 'SEC-API-009',
    policyText: 'All APIs must implement proper authentication, authorization, rate limiting, and input validation. API endpoints must be documented and reviewed for security.',
    policyLink: 'https://docs.company.com/policies/api-security',
    owner: 'Application Security Team',
    lastReviewDate: getRelativeDate(-45),
    nextReviewDate: getRelativeDate(320),
    status: 'ACTIVE',
    frameworks: [
      { id: 'FW-001', controlIds: ['CC7.1', 'CC5.2'] },
      { id: 'FW-002', controlIds: ['Requirement 6.5.10', 'Requirement 6.5.8'] },
      { id: 'FW-004', controlIds: ['A.14.1.3', 'A.14.2.5'] }
    ],
    businessImpact: {
      description: 'Protects API endpoints from unauthorized access and abuse, preventing data exposure and service disruption.',
      severity: 'HIGH',
      financial: [],
      operational: [],
      regulatory: []
    }
  },
  {
    id: 'SML-010',
    name: 'Security Monitoring and Logging Policy',
    policyCode: 'SEC-MON-010',
    policyText: 'All systems must implement comprehensive logging and monitoring. Logs must be centralized, protected, and retained for at least 90 days. Security events must trigger alerts.',
    policyLink: 'https://docs.company.com/policies/security-monitoring',
    owner: 'Security Operations Team',
    lastReviewDate: getRelativeDate(-30),
    nextReviewDate: getRelativeDate(335),
    status: 'ACTIVE',
    frameworks: [
      { id: 'FW-001', controlIds: ['CC7.2', 'CC7.3'] },
      { id: 'FW-002', controlIds: ['Requirement 10.1', 'Requirement 10.2', 'Requirement 10.3'] },
      { id: 'FW-004', controlIds: ['A.12.4.1', 'A.12.4.2', 'A.12.4.3'] }
    ],
    businessImpact: {
      description: 'Enables detection of security incidents and provides forensic evidence for investigations.',
      severity: 'HIGH',
      financial: [],
      operational: [],
      regulatory: []
    }
  },
  {
    id: 'ACC-002',
    name: 'Access Control Policy',
    policyCode: 'SEC-ACC-002',
    policyText: 'Access to systems and data must follow the principle of least privilege. All access must be authenticated, authorized, and regularly reviewed. Privileged access requires MFA.',
    policyLink: 'https://docs.company.com/policies/access-control',
    owner: 'Identity & Access Management Team',
    lastReviewDate: getRelativeDate(-90),
    nextReviewDate: getRelativeDate(275),
    status: 'ACTIVE',
    frameworks: [
      { id: 'FW-001', controlIds: ['CC6.1', 'CC6.2', 'CC6.3'] },
      { id: 'FW-002', controlIds: ['Requirement 7.1', 'Requirement 7.2', 'Requirement 8.3'] },
      { id: 'FW-004', controlIds: ['A.9.1.1', 'A.9.2.3', 'A.9.4.2'] }
    ],
    businessImpact: {
      description: 'Prevents unauthorized access to systems and data, reducing the risk of data breaches and insider threats.',
      severity: 'CRITICAL',
      financial: [],
      operational: [],
      regulatory: []
    }
  },
  {
    id: 'NET-003',
    name: 'Network Security Policy',
    policyCode: 'SEC-NET-003',
    policyText: 'Network traffic must be monitored, filtered, and encrypted where appropriate. Firewalls must be implemented at network boundaries. Remote access requires secure VPN.',
    policyLink: 'https://docs.company.com/policies/network-security',
    owner: 'Network Security Team',
    lastReviewDate: getRelativeDate(-120),
    nextReviewDate: getRelativeDate(245),
    status: 'ACTIVE',
    frameworks: [
      { id: 'FW-001', controlIds: ['CC6.6', 'CC6.7'] },
      { id: 'FW-002', controlIds: ['Requirement 1.1', 'Requirement 1.2', 'Requirement 4.1'] },
      { id: 'FW-004', controlIds: ['A.13.1.1', 'A.13.1.3', 'A.13.2.1'] }
    ],
    businessImpact: {
      description: 'Protects network infrastructure from external attacks and prevents unauthorized data transmission.',
      severity: 'HIGH',
      financial: [],
      operational: [],
      regulatory: []
    }
  },
  {
    id: 'DAT-004',
    name: 'Data Protection Policy',
    policyCode: 'SEC-DAT-004',
    policyText: 'Sensitive data must be encrypted at rest and in transit. Data must be classified and handled according to its sensitivity level. Data retention and disposal must follow regulations.',
    policyLink: 'https://docs.company.com/policies/data-protection',
    owner: 'Data Security Team',
    lastReviewDate: getRelativeDate(-150),
    nextReviewDate: getRelativeDate(215),
    status: 'ACTIVE',
    frameworks: [
      { id: 'FW-001', controlIds: ['CC6.1', 'CC6.7'] },
      { id: 'FW-002', controlIds: ['Requirement 3.1', 'Requirement 3.4', 'Requirement 4.1'] },
      { id: 'FW-004', controlIds: ['A.8.2.1', 'A.8.2.3', 'A.10.1.1'] },
      { id: 'FW-005', controlIds: ['Article 5', 'Article 32'] }
    ],
    businessImpact: {
      description: 'Prevents data breaches and ensures compliance with privacy regulations.',
      severity: 'CRITICAL',
      financial: [],
      operational: [],
      regulatory: []
    }
  }
];

// Sample Vulnerabilities
export const vulnerabilities: Vulnerability[] = [
  {
    id: 'VUL-001',
    title: 'Exposed Jenkins Instance with Weak Authentication',
    description: 'A publicly accessible Jenkins instance was discovered with basic authentication enabled but no additional security controls',
    severity: 'CRITICAL',
    status: 'IN_PROGRESS',
    dateIdentified: getRelativeDate(-2),
    dateUpdated: getRelativeDate(-1),
    
    sourceTools: ['RAPID7'],
    
    affectedRepository: 'infrastructure/ci-cd',
    teamOwner: 'DEVOPS',
    affectedComponent: 'Jenkins CI/CD Server',
    affectedVersion: '2.375.3',
    
    applicabilityAssessment: {
      isApplicable: true,
      justification: 'Confirmed active Jenkins instance exposed to the internet with weak authentication controls',
      assessedBy: 'Attack Surface Management Team',
      assessedDate: getRelativeDate(-1),
      systemAnalysis: [
        {
          systemName: 'Jenkins Production Server',
          isApplicable: true,
          reason: 'Directly exposed to internet without adequate protection',
          affectedComponents: ['Authentication System', 'Build Pipeline'],
          mitigatingControls: ['Basic Authentication']
        }
      ]
    },
    
    impactedPolicies: ['NET-003', 'ACC-002'],
    remediationPlan: 'Move Jenkins behind VPN, implement SSO, enable IP allowlisting, and update security configurations',
    workaround: 'Temporarily restrict access to known IP addresses only',
    toolOutputs: [
      {
        toolName: 'RAPID7',
        summary: 'Internet-exposed Jenkins instance with basic authentication',
        vulnerabilityType: 'Insecure Configuration',
        location: {
          repository: 'infrastructure/ci-cd',
          resourceId: 'jenkins-prod-01',
          cloudProvider: 'AWS',
          region: 'us-east-1'
        },
        recommendation: 'Remove public access and implement proper access controls',
        detectionDate: getRelativeDate(-2),
        cvssScore: 9.1,
        exploitability: 'EASY',
        cveRefs: [
          {
            id: 'CVE-2024-23897',
            summary: 'Jenkins Security Advisory - Multiple vulnerabilities in Jenkins core and plugins',
            link: 'https://nvd.nist.gov/vuln/detail/CVE-2024-23897',
            cvssScore: 9.1,
            cvssVector: 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H',
            publishedDate: '2024-01-24'
          },
          {
            id: 'CVE-2024-23896',
            summary: 'Jenkins core vulnerable to stored XSS via build cause configuration',
            link: 'https://nvd.nist.gov/vuln/detail/CVE-2024-23896',
            cvssScore: 8.8,
            cvssVector: 'CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H',
            publishedDate: '2024-01-24'
          }
        ]
      }
    ],
    complianceImpact: {
      auditRisk: 'HIGH',
      nextAuditDate: getRelativeDate(30),
      primaryFramework: 'SOC 2',
      controlIds: ['CC6.1', 'CC6.2', 'CC6.6', 'CC6.7'],
      nextSteps: {
        technical: [
          {
            step: 'Configure VPN access',
            aiAction: 'Generate VPN configuration template'
          },
          {
            step: 'Implement SSO integration',
            aiAction: 'Review SSO implementation guide'
          },
          {
            step: 'Enable IP allowlisting',
            aiAction: 'Generate IP allowlist policy'
          },
          {
            step: 'Update Jenkins security configurations',
            aiAction: 'Review security hardening checklist'
          },
          {
            step: 'Enable audit logging',
            aiAction: 'Configure logging rules'
          }
        ],
        process: [
          {
            step: 'Review CI/CD access requirements',
            aiAction: 'Generate access matrix'
          },
          {
            step: 'Update access management procedures',
            aiAction: 'Draft procedure updates'
          },
          {
            step: 'Implement regular security scanning',
            aiAction: 'Create scanning schedule'
          }
        ],
        documentation: [
          {
            step: 'Update Jenkins security baseline',
            aiAction: 'Generate baseline doc'
          },
          {
            step: 'Document new access procedures',
            aiAction: 'Draft procedure doc'
          },
          {
            step: 'Update incident response playbook',
            aiAction: 'Update IR playbook'
          }
        ],
        timeline: getRelativeDate(7),
        owner: 'DevOps Security Team'
      }
    },
    remediationDetails: {
      jiraTicket: {
        id: 'SEC-789',
        url: 'https://acme.atlassian.net/browse/SEC-789',
        status: 'In Progress'
      },
      pullRequest: {
        id: '234',
        url: 'https://github.com/acme/infrastructure/pull/234',
        status: 'Draft'
      },
      patchAvailable: true,
      workaroundAvailable: true,
      estimatedEffort: 'MEDIUM',
      assignedTo: 'DevOps Team',
      targetFixDate: getRelativeDate(7)
    },
    exposureDetails: {
      exposedAssets: 1,
      affectedAssets: [
        {
          name: 'jenkins-prod-01',
          resourceType: 'VM',
          details: 'Jenkins CI/CD Server',
          region: 'us-east-1',
          owner: 'Security Operations Team',
          team: 'DEVOPS',
          platform: {
            os: 'Linux',
            version: '2.375.3',
            type: 'Serverless'
          }
        }
      ],
      exposedData: ['Build Configurations', 'Source Code Access', 'Deployment Credentials'],
      attackVector: 'Network',
      attackComplexity: 'LOW',
      privilegesRequired: 'NONE',
      userInteraction: 'NONE',
      scope: 'CHANGED',
      confidentialityImpact: 'HIGH',
      integrityImpact: 'HIGH',
      availabilityImpact: 'HIGH'
    },
    businessImpact: {
      financial: [
        'Potential FCC fines for inadequate network security controls',
        'Service credits due to SLA violations during remediation',
        'Emergency infrastructure security audit costs',
        'Increased costs for enhanced network monitoring systems'
      ],
      regulatory: [
        'Non-compliance with FCC cybersecurity requirements',
        'Violation of Communications Act Section 222 (CPNI protection)',
        'Mandatory reporting to FCC and state telecommunications regulators',
        'Required updates to telecommunications security certifications'
      ],
      operational: [
        'Disruption to automated network configuration deployments',
        'Impact on customer provisioning systems',
        'Delays in network infrastructure updates',
        'Risk to BGP routing system maintenance'
      ],
      customer: [
        'Potential service degradation during security fixes',
        'Risk of exposure of customer network usage data',
        'Impact on business customer MPLS services',
        'Disruption to VoIP service provisioning'
      ]
    }
  },
  {
    id: 'VUL-002',
    title: 'Unauthorized PowerShell Script Execution',
    description: 'Crowdstrike detected suspicious PowerShell activity attempting to disable security controls and establish persistence',
    severity: 'CRITICAL',
    status: 'IN_REVIEW',
    dateIdentified: getRelativeDate(-1),
    dateUpdated: getRelativeDate(0),
    
    sourceTools: ['CROWDSTRIKE EDR'],
    
    affectedRepository: 'endpoints/workstation-fleet',
    teamOwner: 'PLATFORM ENGINEERING',
    affectedComponent: 'Windows Workstations',
    affectedVersion: 'Windows 11 21H2',
    
    applicabilityAssessment: {
      isApplicable: true,
      justification: 'Active malicious PowerShell scripts detected on multiple endpoints',
      assessedBy: 'Security Operations Team',
      assessedDate: getRelativeDate(0),
      systemAnalysis: [
        {
          systemName: 'Engineering Workstations',
          isApplicable: true,
          reason: 'PowerShell execution detected on multiple devices',
          affectedComponents: ['PowerShell', 'Windows Security'],
          mitigatingControls: ['Crowdstrike EDR', 'AppLocker']
        }
      ]
    },
    
    impactedPolicies: ['ACC-002', 'SML-010'],
    remediationPlan: 'Isolate affected endpoints, investigate scope, implement stricter PowerShell controls',
    workaround: 'Temporarily disable PowerShell on affected systems',
    toolOutputs: [
      {
        toolName: 'CROWDSTRIKE EDR',
        summary: 'Malicious PowerShell Activity Detected',
        vulnerabilityType: 'Execution',
        location: {
          repository: 'endpoints/workstation-fleet',
          filePath: 'C:\\Windows\\Temp\\update.ps1',
          lineNumber: 1
        },
        recommendation: 'Implement PowerShell constrained language mode and block unauthorized scripts',
        detectionDate: getRelativeDate(-1),
        cvssScore: 9.8,
        exploitability: 'EASY',
        cveRefs: [
          {
            id: 'CVE-2023-23397',
            summary: 'Microsoft Outlook Elevation of Privilege Vulnerability via PowerShell execution',
            link: 'https://nvd.nist.gov/vuln/detail/CVE-2023-23397',
            cvssScore: 9.8,
            cvssVector: 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H',
            publishedDate: '2023-03-14'
          }
        ]
      }
    ],
    complianceImpact: {
      auditRisk: 'HIGH',
      nextAuditDate: getRelativeDate(30),
      primaryFramework: 'SOC 2',
      controlIds: ['CC6.1', 'CC6.8', 'CC7.2'],
      nextSteps: {
        technical: [
          {
            step: 'Enable PowerShell logging',
            aiAction: 'Generate logging config'
          },
          {
            step: 'Implement constrained language mode',
            aiAction: 'Configure CLM policy'
          },
          {
            step: 'Block unsigned PowerShell scripts',
            aiAction: 'Create script policy'
          },
          {
            step: 'Deploy WDAC policies',
            aiAction: 'Generate WDAC rules'
          }
        ],
        process: [
          {
            step: 'Review PowerShell usage requirements',
            aiAction: 'Analyze usage patterns'
          },
          {
            step: 'Update endpoint security standards',
            aiAction: 'Draft security standards'
          },
          {
            step: 'Enhance monitoring procedures',
            aiAction: 'Create monitoring plan'
          }
        ],
        documentation: [
          {
            step: 'Update incident response playbook',
            aiAction: 'Update IR docs'
          },
          {
            step: 'Document PowerShell security controls',
            aiAction: 'Generate controls doc'
          }
        ],
        timeline: getRelativeDate(3),
        owner: 'Security Operations Team'
      }
    },
    remediationDetails: {
      jiraTicket: {
        id: 'SEC-790',
        url: 'https://acme.atlassian.net/browse/SEC-790',
        status: 'In Progress'
      },
      patchAvailable: true,
      workaroundAvailable: true,
      estimatedEffort: 'HIGH',
      assignedTo: 'Platform Engineering Team',
      targetFixDate: getRelativeDate(3)
    },
    exposureDetails: {
      exposedAssets: 15,
      affectedAssets: [
        {
          name: 'eng-laptop-0472',
          resourceType: 'VM',
          details: 'Engineering Development Workstation',
          region: 'us-east-1',
          owner: 'Sarah Chen',
          team: 'PLATFORM ENGINEERING',
          platform: {
            os: 'Windows',
            version: '11 21H2',
            type: 'Windows'
          }
        },
        {
          name: 'eng-laptop-0389',
          resourceType: 'VM',
          details: 'Network Engineering Workstation',
          region: 'us-east-1',
          owner: 'Michael Rodriguez',
          team: 'NETWORK SECURITY',
          platform: {
            os: 'Windows',
            version: '11 21H2',
            type: 'Windows'
          }
        },
        {
          name: 'eng-desktop-0156',
          resourceType: 'VM',
          details: 'Infrastructure Engineering Workstation',
          region: 'us-east-1',
          owner: 'David Kim',
          team: 'PLATFORM ENGINEERING',
          platform: {
            os: 'Windows',
            version: '11 21H2',
            type: 'Windows'
          }
        },
        {
          name: 'eng-laptop-0521',
          resourceType: 'VM',
          details: 'DevOps Engineering Workstation',
          region: 'us-east-1',
          owner: 'Emily Johnson',
          team: 'DEVOPS',
          platform: {
            os: 'Windows',
            version: '11 21H2',
            type: 'Windows'
          }
        },
        {
          name: 'eng-laptop-0498',
          resourceType: 'VM',
          details: 'Network Operations Workstation',
          region: 'us-east-1',
          owner: 'James Wilson',
          team: 'NETWORK SECURITY',
          platform: {
            os: 'Windows',
            version: '11 21H2',
            type: 'Windows'
          }
        }
      ],
      exposedData: ['System Access', 'User Credentials', 'Security Controls'],
      attackVector: 'Local',
      attackComplexity: 'LOW',
      privilegesRequired: 'LOW',
      userInteraction: 'NONE',
      scope: 'CHANGED',
      confidentialityImpact: 'HIGH',
      integrityImpact: 'HIGH',
      availabilityImpact: 'HIGH'
    },
    businessImpact: {
      financial: [
        'Emergency response costs for network operations center',
        'Revenue loss from impacted business services',
        'Security remediation costs across affected systems',
        'Potential customer compensation for service impacts'
      ],
      regulatory: [
        'Violation of telecommunications data protection requirements',
        'Non-compliance with state broadband service regulations',
        'Required reporting to telecommunications regulators',
        'Impact on common carrier compliance status'
      ],
      operational: [
        'Disruption to network management systems',
        'Impact on customer support tools and dashboards',
        'Delays in service provisioning workflows',
        'Risk to network monitoring capabilities'
      ],
      customer: [
        'Degraded service quality for enterprise customers',
        'Delays in processing service changes and upgrades',
        'Impact on business customer SLA commitments',
        'Risk to managed service delivery'
      ]
    }
  },
  {
    id: 'VUL-003',
    title: 'Potential Data Exfiltration Activity',
    description: 'Crowdstrike detected unusual outbound data transfer patterns indicating potential data exfiltration attempt',
    severity: 'HIGH',
    status: 'FIXED',
    dateIdentified: getRelativeDate(-1),
    dateUpdated: getRelativeDate(0),
    
    sourceTools: ['CROWDSTRIKE EDR'],
    
    affectedRepository: 'endpoints/server-fleet',
    teamOwner: 'NETWORK SECURITY',
    affectedComponent: 'Linux Application Servers',
    affectedVersion: 'Ubuntu 22.04 LTS',
    
    applicabilityAssessment: {
      isApplicable: true,
      justification: 'Unusual data transfer patterns detected from production application servers to unknown external endpoints',
      assessedBy: 'Security Operations Team',
      assessedDate: getRelativeDate(0),
      systemAnalysis: [
        {
          systemName: 'Application Servers',
          isApplicable: true,
          reason: 'Anomalous network traffic detected',
          affectedComponents: ['Network Stack', 'Application Process'],
          mitigatingControls: ['Crowdstrike EDR', 'Network Firewall']
        }
      ]
    },
    
    impactedPolicies: ['DAT-004', 'NET-003'],
    remediationPlan: 'Block suspicious connections, analyze transferred data, implement additional network controls',
    workaround: 'Temporarily restrict all outbound connections to approved list',
    toolOutputs: [
      {
        toolName: 'CROWDSTRIKE EDR',
        summary: 'Suspicious Data Transfer Activity',
        vulnerabilityType: 'Data Exfiltration',
        location: {
          repository: 'endpoints/server-fleet',
          resourceId: 'app-server-prod-01',
          cloudProvider: 'AWS',
          region: 'us-east-1'
        },
        recommendation: 'Implement network segmentation and enhanced monitoring',
        detectionDate: getRelativeDate(-1),
        cvssScore: 8.2,
        exploitability: 'MODERATE',
        cveRefs: [
          {
            id: 'CVE-2023-48795',
            summary: 'SSH protocol vulnerability "Terrapin Attack" enabling potential data exfiltration',
            link: 'https://nvd.nist.gov/vuln/detail/CVE-2023-48795',
            cvssScore: 8.2,
            cvssVector: 'CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N',
            publishedDate: '2023-12-18'
          }
        ]
      }
    ],
    complianceImpact: {
      auditRisk: 'HIGH',
      nextAuditDate: getRelativeDate(30),
      primaryFramework: 'PCI-DSS',
      controlIds: ['Requirement 10.6.1', 'Requirement 1.3.4'],
      nextSteps: {
        technical: [
          {
            step: 'Implement network segmentation',
            aiAction: 'Design network zones'
          },
          {
            step: 'Deploy data loss prevention',
            aiAction: 'Configure DLP rules'
          },
          {
            step: 'Enhanced network monitoring',
            aiAction: 'Setup monitoring alerts'
          },
          {
            step: 'Update firewall rules',
            aiAction: 'Generate firewall config'
          }
        ],
        process: [
          {
            step: 'Review data handling procedures',
            aiAction: 'Analyze data flows'
          },
          {
            step: 'Update incident response plan',
            aiAction: 'Update IR procedures'
          },
          {
            step: 'Enhance monitoring procedures',
            aiAction: 'Create monitoring SOP'
          }
        ],
        documentation: [
          {
            step: 'Document incident timeline',
            aiAction: 'Generate timeline'
          },
          {
            step: 'Update network security baseline',
            aiAction: 'Update baseline doc'
          }
        ],
        timeline: getRelativeDate(2),
        owner: 'Security Operations Team'
      }
    },
    remediationDetails: {
      jiraTicket: {
        id: 'SEC-791',
        url: 'https://acme.atlassian.net/browse/SEC-791',
        status: 'IN_REVIEW'
      },
      pullRequest: {
        id: 'PR-123',
        url: 'https://github.com/acme/endpoints/pull/123',
        status: 'IN_REVIEW'
      },
      patchAvailable: false,
      workaroundAvailable: true,
      estimatedEffort: 'MEDIUM',
      assignedTo: 'Network Security Team',
      targetFixDate: getRelativeDate(2)
    },
    exposureDetails: {
      exposedAssets: 3,
      affectedAssets: [
        {
          name: 'prod-app-server-01',
          resourceType: 'VM',
          details: 'Production application server running core services',
          region: 'us-east-1',
          owner: 'John Smith',
          team: 'PLATFORM ENGINEERING',
          platform: {
            os: 'Ubuntu',
            version: '22.04 LTS',
            type: 'Linux'
          }
        },
        {
          name: 'prod-db-cluster',
          resourceType: 'Database',
          details: 'Primary production database cluster',
          region: 'us-east-1',
          owner: 'Sarah Johnson',
          team: 'DATA ENGINEERING',
          platform: {
            type: 'Other'
          }
        },
        {
          name: 'prod-api-gateway',
          resourceType: 'API',
          details: 'Main API Gateway for customer-facing services',
          region: 'us-east-1',
          owner: 'Mike Wilson',
          team: 'PLATFORM ENGINEERING',
          platform: {
            type: 'Serverless'
          }
        }
      ],
      exposedData: ['Application Data', 'System Configuration', 'Network Traffic'],
      attackVector: 'Network',
      attackComplexity: 'HIGH',
      privilegesRequired: 'LOW',
      userInteraction: 'NONE',
      scope: 'CHANGED',
      confidentialityImpact: 'HIGH',
      integrityImpact: 'LOW',
      availabilityImpact: 'LOW'
    },
    businessImpact: {
      financial: [
        'Costs of network traffic forensics investigation',
        'Customer data breach notification expenses',
        'Potential class action lawsuit liabilities',
        'Lost revenue from customer contract terminations'
      ],
      regulatory: [
        'CPNI (Customer Proprietary Network Information) violations',
        'FCC data privacy rule infractions',
        'State telecommunications privacy law violations',
        'Non-compliance with data retention requirements'
      ],
      operational: [
        'Emergency network traffic re-routing',
        'Impact on CDN and peering connections',
        'Disruption to traffic analysis systems',
        'Required BGP route modifications'
      ],
      customer: [
        'Exposure of customer traffic patterns',
        'Impact on enterprise customer VPNs',
        'Risk to hosted telecommunications services',
        'Disruption to managed security services'
      ]
    }
  },
  {
    id: 'VUL-004',
    title: 'BGP Route Leak Detection',
    description: 'External scanning detected potential BGP route leak affecting customer prefixes',
    severity: 'CRITICAL',
    status: 'OPEN',
    dateIdentified: getRelativeDate(-1),
    dateUpdated: getRelativeDate(0),
    
    sourceTools: ['ZAFRAN'],
    
    affectedRepository: 'network/bgp-config',
    teamOwner: 'NETWORK SECURITY',
    affectedComponent: 'BGP Edge Routers',
    affectedVersion: 'IOS-XR 7.5.2',
    
    applicabilityAssessment: {
      isApplicable: true,
      justification: 'Active route leak affecting multiple enterprise customer prefixes',
      assessedBy: 'Network Operations Team',
      assessedDate: getRelativeDate(0),
      systemAnalysis: [
        {
          systemName: 'Edge Router Cluster',
          isApplicable: true,
          reason: 'Incorrect route advertisements detected',
          affectedComponents: ['BGP Process', 'Route Policy'],
          mitigatingControls: ['RPKI', 'Route Filters']
        }
      ]
    },
    
    impactedPolicies: ['NET-001', 'SLA-002'],
    remediationPlan: 'Implement stricter route filtering, validate RPKI configurations, update BGP policies',
    workaround: 'Manually withdraw affected routes and apply temporary filters',
    toolOutputs: [
      {
        toolName: 'ZAFRAN',
        summary: 'BGP Route Leak Detected',
        vulnerabilityType: 'Network Configuration',
        location: {
          repository: 'network/bgp-config',
          filePath: 'edge-routers/route-policy.cfg',
          lineNumber: 156
        },
        recommendation: 'Implement ROA validation and update route filters',
        detectionDate: getRelativeDate(-1),
        cvssScore: 8.9,
        exploitability: 'MODERATE',
        cveRefs: [
          {
            id: 'CVE-2023-2928',
            summary: 'BGP implementation vulnerability in route validation',
            link: 'https://nvd.nist.gov/vuln/detail/CVE-2023-2928',
            cvssScore: 8.9,
            cvssVector: 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:H',
            publishedDate: '2023-06-15'
          }
        ]
      }
    ],
    complianceImpact: {
      auditRisk: 'HIGH',
      nextAuditDate: getRelativeDate(30),
      primaryFramework: 'ISO 27001',
      controlIds: ['A.13.1.1', 'A.13.1.2'],
      nextSteps: {
        technical: [
          {
            step: 'Update route filters',
            aiAction: 'Generate route filter config'
          },
          {
            step: 'Configure RPKI validation',
            aiAction: 'Setup RPKI config'
          },
          {
            step: 'Implement prefix limits',
            aiAction: 'Generate prefix limits'
          },
          {
            step: 'Deploy route monitoring',
            aiAction: 'Create monitoring rules'
          }
        ],
        process: [
          {
            step: 'Review BGP peering policies',
            aiAction: 'Analyze peering config'
          },
          {
            step: 'Update route validation procedures',
            aiAction: 'Draft validation SOP'
          },
          {
            step: 'Enhance monitoring procedures',
            aiAction: 'Create BGP monitoring plan'
          }
        ],
        documentation: [
          {
            step: 'Update BGP security baseline',
            aiAction: 'Generate baseline doc'
          },
          {
            step: 'Document route leak response',
            aiAction: 'Create response playbook'
          }
        ],
        timeline: getRelativeDate(1),
        owner: 'Network Security Team'
      }
    },
    remediationDetails: {
      jiraTicket: {
        id: 'NET-156',
        url: 'https://acme.atlassian.net/browse/NET-156',
        status: 'In Progress'
      },
      patchAvailable: true,
      workaroundAvailable: true,
      estimatedEffort: 'HIGH',
      assignedTo: 'Network Operations Team',
      targetFixDate: getRelativeDate(1)
    },
    exposureDetails: {
      exposedAssets: 4,
      affectedAssets: [
        {
          name: 'edge-rtr-01',
          resourceType: 'Other',
          details: 'Primary Edge Router',
          region: 'us-east-1',
          owner: 'Network Operations',
          team: 'NETWORK SECURITY',
          platform: {
            os: 'IOS-XR',
            version: '7.5.2',
            type: 'Other'
          }
        },
        {
          name: 'edge-rtr-02',
          resourceType: 'Other',
          details: 'Secondary Edge Router',
          region: 'us-east-1',
          owner: 'Network Operations',
          team: 'NETWORK SECURITY',
          platform: {
            os: 'IOS-XR',
            version: '7.5.2',
            type: 'Other'
          }
        }
      ],
      exposedData: ['BGP Routes', 'Network Topology', 'Customer Prefixes'],
      attackVector: 'Network',
      attackComplexity: 'HIGH',
      privilegesRequired: 'NONE',
      userInteraction: 'NONE',
      scope: 'CHANGED',
      confidentialityImpact: 'LOW',
      integrityImpact: 'HIGH',
      availabilityImpact: 'HIGH'
    },
    businessImpact: {
      financial: [
        'SLA violation penalties for affected customers',
        'Emergency response team costs',
        'Potential customer compensation claims',
        'Lost revenue from service disruption'
      ],
      regulatory: [
        'FCC reporting requirements for network incident',
        'State telecommunications commission notifications',
        'Required updates to network reliability reports',
        'Compliance review with routing security standards'
      ],
      operational: [
        'Network routing instability',
        'Customer traffic disruption',
        'Increased latency and packet loss',
        'Peer relationship impact'
      ],
      customer: [
        'Enterprise customer connectivity issues',
        'Degraded service quality',
        'Potential data routing concerns',
        'Business service interruptions'
      ]
    }
  },
  {
    id: 'VUL-005',
    title: 'Critical DNS Server Vulnerabilities',
    description: 'Multiple critical vulnerabilities detected in production DNS infrastructure',
    severity: 'CRITICAL',
    status: 'IN_REVIEW',
    dateIdentified: getRelativeDate(-2),
    dateUpdated: getRelativeDate(0),
    
    sourceTools: ['RAPID7', 'QUALYS'],
    
    affectedRepository: 'infrastructure/dns-servers',
    teamOwner: 'PLATFORM ENGINEERING',
    affectedComponent: 'DNS Server Infrastructure',
    affectedVersion: 'BIND 9.16.27',
    
    applicabilityAssessment: {
      isApplicable: true,
      justification: 'Critical vulnerabilities affecting production DNS servers',
      assessedBy: 'Platform Security Team',
      assessedDate: getRelativeDate(-1),
      systemAnalysis: [
        {
          systemName: 'Primary DNS Cluster',
          isApplicable: true,
          reason: 'Multiple vulnerabilities detected',
          affectedComponents: ['BIND', 'DNS Cache', 'Zone Transfer'],
          mitigatingControls: ['WAF', 'DDoS Protection']
        }
      ]
    },
    
    impactedPolicies: ['DNS-001', 'SEC-003'],
    remediationPlan: 'Upgrade DNS servers, implement additional security controls, enhance monitoring',
    workaround: 'Apply temporary access restrictions and increase monitoring',
    toolOutputs: [
      {
        toolName: 'RAPID7',
        summary: 'Multiple DNS Server Vulnerabilities',
        vulnerabilityType: 'DNS Security',
        location: {
          repository: 'infrastructure/dns-servers',
          resourceId: 'dns-prod-cluster',
          cloudProvider: 'AWS',
          region: 'us-east-1'
        },
        recommendation: 'Upgrade BIND version and implement additional security controls',
        detectionDate: getRelativeDate(-2),
        cvssScore: 9.8,
        exploitability: 'EASY',
        cveRefs: [
          {
            id: 'CVE-2023-2911',
            summary: 'BIND remote code execution vulnerability',
            link: 'https://nvd.nist.gov/vuln/detail/CVE-2023-2911',
            cvssScore: 9.8,
            cvssVector: 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H',
            publishedDate: '2023-05-16'
          }
        ]
      },
      {
        toolName: 'QUALYS',
        summary: 'DNS Cache Poisoning Vulnerability',
        vulnerabilityType: 'DNS Security',
        location: {
          repository: 'infrastructure/dns-servers',
          resourceId: 'dns-prod-cluster',
          cloudProvider: 'AWS',
          region: 'us-east-1'
        },
        recommendation: 'Implement DNSSEC and additional cache security measures',
        detectionDate: getRelativeDate(-2),
        cvssScore: 8.6,
        exploitability: 'MODERATE'
      }
    ],
    complianceImpact: {
      auditRisk: 'HIGH',
      nextAuditDate: getRelativeDate(30),
      primaryFramework: 'ISO 27001',
      controlIds: ['A.13.1.3', 'A.14.2.2'],
      nextSteps: {
        technical: [
          {
            step: 'Upgrade BIND version',
            aiAction: 'Generate upgrade plan'
          },
          {
            step: 'Implement DNSSEC',
            aiAction: 'Configure DNSSEC'
          },
          {
            step: 'Deploy DNS filtering',
            aiAction: 'Setup filter rules'
          },
          {
            step: 'Enhance monitoring',
            aiAction: 'Create DNS alerts'
          }
        ],
        process: [
          {
            step: 'Review DNS security policies',
            aiAction: 'Analyze DNS config'
          },
          {
            step: 'Update change procedures',
            aiAction: 'Draft change process'
          },
          {
            step: 'Implement validation checks',
            aiAction: 'Create validation plan'
          }
        ],
        documentation: [
          {
            step: 'Update DNS security baseline',
            aiAction: 'Generate baseline doc'
          },
          {
            step: 'Document upgrade process',
            aiAction: 'Create upgrade guide'
          }
        ],
        timeline: getRelativeDate(3),
        owner: 'Platform Engineering Team'
      }
    },
    remediationDetails: {
      jiraTicket: {
        id: 'SEC-792',
        url: 'https://acme.atlassian.net/browse/SEC-792',
        status: 'In Progress'
      },
      patchAvailable: true,
      workaroundAvailable: true,
      estimatedEffort: 'HIGH',
      assignedTo: 'Platform Engineering Team',
      targetFixDate: getRelativeDate(3)
    },
    exposureDetails: {
      exposedAssets: 6,
      affectedAssets: [
        {
          name: 'dns-primary-01',
          resourceType: 'VM',
          details: 'Primary DNS Server',
          region: 'us-east-1',
          owner: 'DNS Operations',
          team: 'PLATFORM ENGINEERING',
          platform: {
            os: 'Ubuntu',
            version: '22.04 LTS',
            type: 'Linux'
          }
        },
        {
          name: 'dns-secondary-01',
          resourceType: 'VM',
          details: 'Secondary DNS Server',
          region: 'us-west-2',
          owner: 'DNS Operations',
          team: 'PLATFORM ENGINEERING',
          platform: {
            os: 'Ubuntu',
            version: '22.04 LTS',
            type: 'Linux'
          }
        }
      ],
      exposedData: ['DNS Records', 'Zone Files', 'Query Logs'],
      attackVector: 'Network',
      attackComplexity: 'LOW',
      privilegesRequired: 'NONE',
      userInteraction: 'NONE',
      scope: 'CHANGED',
      confidentialityImpact: 'HIGH',
      integrityImpact: 'HIGH',
      availabilityImpact: 'HIGH'
    },
    businessImpact: {
      financial: [
        'Emergency patching and upgrade costs',
        'Potential service disruption penalties',
        'Additional monitoring system expenses',
        'Customer support resource allocation'
      ],
      regulatory: [
        'FCC DNS security compliance requirements',
        'DNSSEC implementation mandates',
        'Critical infrastructure protection regulations',
        'Security incident reporting obligations'
      ],
      operational: [
        'DNS resolution disruption risk',
        'Service availability impact',
        'DNS propagation delays',
        'Cache consistency issues'
      ],
      customer: [
        'Website accessibility problems',
        'Email delivery disruptions',
        'Service connectivity issues',
        'DNS resolution failures'
      ]
    }
  },
  {
    id: 'VUL-006',
    title: 'Model Weight Exfiltration Vulnerability',
    description: 'Potential unauthorized access to model weights through insecure model serving infrastructure',
    severity: 'CRITICAL',
    status: 'IN_REVIEW',
    dateIdentified: getRelativeDate(-1),
    dateUpdated: getRelativeDate(0),
    
    sourceTools: ['CREDO AI'],
    
    affectedRepository: 'ai-platform/model-serving',
    teamOwner: 'AI PLATFORM ENGINEERING',
    affectedComponent: 'Model Serving Infrastructure',
    affectedVersion: 'TensorFlow Serving 2.13.0',
    
    applicabilityAssessment: {
      isApplicable: true,
      justification: 'Critical vulnerability affecting proprietary model weights',
      assessedBy: 'AI Platform Team',
      assessedDate: getRelativeDate(0),
      systemAnalysis: [
        {
          systemName: 'Model Serving Cluster',
          isApplicable: true,
          reason: 'Exposed internal model endpoints',
          affectedComponents: ['Model Server', 'API Gateway', 'Model Storage'],
          mitigatingControls: ['Access Control', 'Network Segmentation']
        }
      ]
    },
    
    impactedPolicies: ['AI-001', 'SEC-005'],
    remediationPlan: 'Implement model access controls, encrypt model weights, enhance API security',
    workaround: 'Restrict model endpoint access to internal networks only',
    toolOutputs: [
      {
        toolName: 'CREDO AI',
        summary: 'Insecure Model Server Configuration',
        vulnerabilityType: 'Access Control',
        location: {
          repository: 'ai-platform/model-serving',
          resourceId: 'model-prod-cluster',
          cloudProvider: 'AWS',
          region: 'us-east-1'
        },
        recommendation: 'Implement model encryption and access controls',
        detectionDate: getRelativeDate(-1),
        cvssScore: 8.7,
        exploitability: 'MODERATE',
        cveRefs: [
          {
            id: 'CVE-2023-41892',
            summary: 'TensorFlow Serving information disclosure vulnerability',
            link: 'https://nvd.nist.gov/vuln/detail/CVE-2023-41892',
            cvssScore: 8.7,
            cvssVector: 'CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N',
            publishedDate: '2023-09-12'
          }
        ]
      }
    ],
    complianceImpact: {
      auditRisk: 'HIGH',
      nextAuditDate: getRelativeDate(30),
      primaryFramework: 'ISO 27001',
      controlIds: ['A.8.2.1', 'A.13.1.3'],
      nextSteps: {
        technical: [
          {
            step: 'Implement model encryption',
            aiAction: 'Generate encryption config'
          },
          {
            step: 'Configure access controls',
            aiAction: 'Setup IAM policies'
          },
          {
            step: 'Enhance API security',
            aiAction: 'Generate API policies'
          },
          {
            step: 'Deploy monitoring',
            aiAction: 'Create monitoring rules'
          }
        ],
        process: [
          {
            step: 'Review model access policies',
            aiAction: 'Analyze access patterns'
          },
          {
            step: 'Update deployment procedures',
            aiAction: 'Draft deployment guide'
          },
          {
            step: 'Implement security checks',
            aiAction: 'Create security checklist'
          }
        ],
        documentation: [
          {
            step: 'Update security baseline',
            aiAction: 'Generate baseline doc'
          },
          {
            step: 'Document model security',
            aiAction: 'Create security guide'
          }
        ],
        timeline: getRelativeDate(2),
        owner: 'AI Platform Team'
      }
    },
    remediationDetails: {
      jiraTicket: {
        id: 'AI-156',
        url: 'https://acme.atlassian.net/browse/AI-156',
        status: 'In Progress'
      },
      patchAvailable: true,
      workaroundAvailable: true,
      estimatedEffort: 'HIGH',
      assignedTo: 'Platform Engineering Team',
      targetFixDate: getRelativeDate(2)
    },
    exposureDetails: {
      exposedAssets: 3,
      affectedAssets: [
        {
          name: 'model-server-01',
          resourceType: 'Container',
          details: 'Primary Model Serving Cluster',
          region: 'us-east-1',
          owner: 'AI Platform Team',
          team: 'AI PLATFORM ENGINEERING',
          platform: {
            os: 'Ubuntu',
            version: '22.04 LTS',
            type: 'Container'
          }
        },
        {
          name: 'model-storage',
          resourceType: 'Storage',
          details: 'Model Weights Storage',
          region: 'us-east-1',
          owner: 'AI Platform Team',
          team: 'AI PLATFORM ENGINEERING',
          platform: {
            type: 'Other'
          }
        }
      ],
      exposedData: ['Model Weights', 'Model Architecture', 'Training Data'],
      attackVector: 'Network',
      attackComplexity: 'HIGH',
      privilegesRequired: 'LOW',
      userInteraction: 'NONE',
      scope: 'CHANGED',
      confidentialityImpact: 'HIGH',
      integrityImpact: 'LOW',
      availabilityImpact: 'LOW'
    },
    businessImpact: {
      financial: [
        'Loss of proprietary model intellectual property',
        'Model retraining and validation costs',
        'Security infrastructure upgrades',
        'Potential competitive advantage loss'
      ],
      regulatory: [
        'AI model security compliance requirements',
        'Intellectual property protection mandates',
        'Data protection regulations',
        'Security audit requirements'
      ],
      operational: [
        'Model serving disruption',
        'Deployment pipeline changes',
        'Access control implementation',
        'Security monitoring overhead'
      ],
      customer: [
        'Service availability impact',
        'Model inference delays',
        'API integration disruption',
        'Security control friction'
      ]
    }
  },
  {
    id: 'VUL-007',
    title: 'Prompt Injection Vulnerability',
    description: 'Critical prompt injection vulnerability in AI model API gateway',
    severity: 'HIGH',
    status: 'OPEN',
    dateIdentified: getRelativeDate(-1),
    dateUpdated: getRelativeDate(0),
    
    sourceTools: ['PROTECT AI'],
    
    affectedRepository: 'ai-platform/api-gateway',
    teamOwner: 'AI PLATFORM ENGINEERING',
    affectedComponent: 'AI Model API Gateway',
    affectedVersion: 'API Gateway v2.1.0',
    
    applicabilityAssessment: {
      isApplicable: true,
      justification: 'Active prompt injection vulnerability affecting customer API endpoints',
      assessedBy: 'Security Team',
      assessedDate: getRelativeDate(0),
      systemAnalysis: [
        {
          systemName: 'API Gateway Cluster',
          isApplicable: true,
          reason: 'Insufficient prompt sanitization',
          affectedComponents: ['Input Validation', 'Prompt Processing', 'Response Filtering'],
          mitigatingControls: ['Rate Limiting', 'Token Validation']
        }
      ]
    },
    
    impactedPolicies: ['API-001', 'AI-002'],
    remediationPlan: 'Implement prompt validation, enhance input sanitization, add response filtering',
    workaround: 'Enable strict input validation and reduce token limits',
    toolOutputs: [
      {
        toolName: 'PROTECT AI',
        summary: 'Prompt Injection Vulnerability',
        vulnerabilityType: 'Input Validation',
        location: {
          repository: 'ai-platform/api-gateway',
          filePath: 'src/validators/prompt.ts',
          lineNumber: 45
        },
        recommendation: 'Implement comprehensive prompt validation and sanitization',
        detectionDate: getRelativeDate(-1),
        cvssScore: 7.5,
        exploitability: 'EASY'
      }
    ],
    complianceImpact: {
      auditRisk: 'HIGH',
      nextAuditDate: getRelativeDate(30),
      primaryFramework: 'ISO 27001',
      controlIds: ['A.14.2.5', 'A.14.1.2'],
      nextSteps: {
        technical: [
          {
            step: 'Implement input validation',
            aiAction: 'Generate validation rules'
          },
          {
            step: 'Add prompt sanitization',
            aiAction: 'Create sanitization logic'
          },
          {
            step: 'Deploy response filtering',
            aiAction: 'Setup filter config'
          },
          {
            step: 'Enhance monitoring',
            aiAction: 'Create alert rules'
          }
        ],
        process: [
          {
            step: 'Review API security',
            aiAction: 'Analyze API patterns'
          },
          {
            step: 'Update validation process',
            aiAction: 'Draft validation guide'
          },
          {
            step: 'Implement security testing',
            aiAction: 'Create test suite'
          }
        ],
        documentation: [
          {
            step: 'Update API security docs',
            aiAction: 'Generate API guide'
          },
          {
            step: 'Document validation rules',
            aiAction: 'Create rules doc'
          }
        ],
        timeline: getRelativeDate(3),
        owner: 'Platform Security Team'
      }
    },
    remediationDetails: {
      jiraTicket: {
        id: 'API-234',
        url: 'https://acme.atlassian.net/browse/API-234',
        status: 'Open'
      },
      patchAvailable: true,
      workaroundAvailable: true,
      estimatedEffort: 'MEDIUM',
      assignedTo: 'Platform Engineering Team',
      targetFixDate: getRelativeDate(3)
    },
    exposureDetails: {
      exposedAssets: 2,
      affectedAssets: [
        {
          name: 'api-gateway-prod',
          resourceType: 'API',
          details: 'Production API Gateway',
          region: 'us-east-1',
          owner: 'Platform Team',
          team: 'AI PLATFORM ENGINEERING',
          platform: {
            type: 'Container'
          }
        },
        {
          name: 'model-inference-api',
          resourceType: 'API',
          details: 'Model Inference Endpoint',
          region: 'us-east-1',
          owner: 'AI Platform Team',
          team: 'AI PLATFORM ENGINEERING',
          platform: {
            type: 'Container'
          }
        }
      ],
      exposedData: ['Model Prompts', 'API Responses', 'Usage Patterns'],
      attackVector: 'API',
      attackComplexity: 'LOW',
      privilegesRequired: 'NONE',
      userInteraction: 'NONE',
      scope: 'CHANGED',
      confidentialityImpact: 'HIGH',
      integrityImpact: 'HIGH',
      availabilityImpact: 'LOW'
    },
    businessImpact: {
      financial: [
        'Increased API processing costs',
        'Security control implementation expenses',
        'Potential SLA violation penalties',
        'Engineering resource allocation'
      ],
      regulatory: [
        'AI safety compliance requirements',
        'API security standards',
        'Data protection regulations',
        'Security control documentation'
      ],
      operational: [
        'API performance impact',
        'Increased latency from validation',
        'Development workflow changes',
        'Monitoring overhead'
      ],
      customer: [
        'API response delays',
        'False positive blocks',
        'Integration friction',
        'Usage pattern changes'
      ]
    }
  },
  {
    id: 'VUL-008',
    title: 'Mobile App Authentication Bypass',
    description: 'Critical authentication bypass vulnerability in mobile app token validation',
    severity: 'CRITICAL',
    status: 'OPEN',
    dateIdentified: getRelativeDate(-1),
    dateUpdated: getRelativeDate(0),
    
    sourceTools: ['RAPID7'],
    
    affectedRepository: 'mobile/customer-app',
    teamOwner: 'MOBILE ENGINEERING',
    affectedComponent: 'Mobile App Authentication Module',
    affectedVersion: 'v3.2.1',
    
    applicabilityAssessment: {
      isApplicable: true,
      justification: 'Authentication bypass affects all mobile app users',
      assessedBy: 'Mobile Security Team',
      assessedDate: getRelativeDate(0),
      systemAnalysis: [
        {
          systemName: 'Mobile App',
          isApplicable: true,
          reason: 'Vulnerable token validation logic',
          affectedComponents: ['Auth Module', 'API Client', 'Token Manager'],
          mitigatingControls: ['Server-side Validation', 'Rate Limiting']
        }
      ]
    },
    
    impactedPolicies: ['MOB-001', 'SEC-002'],
    remediationPlan: 'Update token validation logic, implement additional server-side checks',
    workaround: 'Enable strict server-side validation temporarily',
    toolOutputs: [
      {
        toolName: 'RAPID7',
        summary: 'Authentication Bypass in Mobile App',
        vulnerabilityType: 'Authentication',
        location: {
          repository: 'mobile/customer-app',
          filePath: 'src/auth/TokenValidator.ts',
          lineNumber: 127
        },
        recommendation: 'Implement proper token validation and signature verification',
        detectionDate: getRelativeDate(-1),
        cvssScore: 9.1,
        exploitability: 'EASY',
        cveRefs: [
          {
            id: 'CVE-2024-21567',
            summary: 'Authentication bypass vulnerability in mobile token validation',
            link: 'https://nvd.nist.gov/vuln/detail/CVE-2024-21567',
            cvssScore: 9.1,
            cvssVector: 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N',
            publishedDate: '2024-01-15'
          }
        ]
      }
    ],
    complianceImpact: {
      auditRisk: 'HIGH',
      nextAuditDate: getRelativeDate(30),
      primaryFramework: 'OWASP MASVS',
      controlIds: ['MSTG-AUTH-3', 'MSTG-AUTH-4'],
      nextSteps: {
        technical: [
          {
            step: 'Update token validation',
            aiAction: 'Generate validation code'
          },
          {
            step: 'Implement signature checks',
            aiAction: 'Setup crypto config'
          },
          {
            step: 'Add security headers',
            aiAction: 'Generate headers config'
          }
        ],
        process: [
          {
            step: 'Review auth architecture',
            aiAction: 'Analyze auth flow'
          },
          {
            step: 'Update security testing',
            aiAction: 'Create test cases'
          }
        ],
        documentation: [
          {
            step: 'Update auth documentation',
            aiAction: 'Generate auth docs'
          },
          {
            step: 'Document security controls',
            aiAction: 'Create controls doc'
          }
        ],
        timeline: getRelativeDate(2),
        owner: 'Mobile Security Team'
      }
    },
    remediationDetails: {
      jiraTicket: {
        id: 'MOB-345',
        url: 'https://acme.atlassian.net/browse/MOB-345',
        status: 'In Progress'
      },
      patchAvailable: true,
      workaroundAvailable: true,
      estimatedEffort: 'MEDIUM',
      assignedTo: 'Mobile Engineering Team',
      targetFixDate: getRelativeDate(2)
    },
    exposureDetails: {
      exposedAssets: 2,
      affectedAssets: [
        {
          name: 'ios-app',
          resourceType: 'Other',
          details: 'iOS Customer App',
          region: 'global',
          owner: 'Mobile Team',
          team: 'MOBILE ENGINEERING',
          platform: {
            os: 'iOS',
            version: '17.0+',
            type: 'Other'
          }
        },
        {
          name: 'android-app',
          resourceType: 'Other',
          details: 'Android Customer App',
          region: 'global',
          owner: 'Mobile Team',
          team: 'MOBILE ENGINEERING',
          platform: {
            os: 'Android',
            version: '13.0+',
            type: 'Other'
          }
        }
      ],
      exposedData: ['Authentication Tokens', 'User Credentials', 'Session Data'],
      attackVector: 'Network',
      attackComplexity: 'LOW',
      privilegesRequired: 'NONE',
      userInteraction: 'NONE',
      scope: 'CHANGED',
      confidentialityImpact: 'HIGH',
      integrityImpact: 'HIGH',
      availabilityImpact: 'LOW'
    },
    businessImpact: {
      financial: [
        'Potential fraud losses',
        'Emergency app update costs',
        'Incident response expenses',
        'Customer support surge costs'
      ],
      regulatory: [
        'Mobile app security compliance',
        'Data protection requirements',
        'App store security standards',
        'Privacy regulation compliance'
      ],
      operational: [
        'Emergency app release required',
        'Authentication system changes',
        'API gateway modifications',
        'Security monitoring updates'
      ],
      customer: [
        'Forced app updates',
        'Potential account compromise',
        'Authentication failures',
        'App store rating impact'
      ]
    }
  },
  {
    id: 'VUL-009',
    title: 'Malicious SDK Detected',
    description: 'Malicious behavior detected in third-party analytics SDK used in mobile app',
    severity: 'HIGH',
    status: 'IN_PROGRESS',
    dateIdentified: getRelativeDate(-2),
    dateUpdated: getRelativeDate(0),
    
    sourceTools: ['CROWDSTRIKE FALCON'],
    
    affectedRepository: 'mobile/customer-app',
    teamOwner: 'MOBILE ENGINEERING',
    affectedComponent: 'Third-party Analytics SDK',
    affectedVersion: 'AnalyticsSDK 2.1.0',
    
    applicabilityAssessment: {
      isApplicable: true,
      justification: 'Malicious SDK is present in production mobile app',
      assessedBy: 'Security Team',
      assessedDate: getRelativeDate(-1),
      systemAnalysis: [
        {
          systemName: 'Mobile App',
          isApplicable: true,
          reason: 'SDK included in app bundle',
          affectedComponents: ['Analytics Module', 'Data Collection', 'Network Layer'],
          mitigatingControls: ['App Permissions', 'Network Monitoring']
        }
      ]
    },
    
    impactedPolicies: ['MOB-002', 'SEC-007'],
    remediationPlan: 'Remove malicious SDK, implement alternative analytics solution',
    workaround: 'Disable SDK functionality via feature flag',
    toolOutputs: [
      {
        toolName: 'CROWDSTRIKE FALCON',
        summary: 'Malicious Network Activity from Mobile SDK',
        vulnerabilityType: 'Malicious Code',
        location: {
          repository: 'mobile/customer-app',
          filePath: 'ios/Pods/AnalyticsSDK/',
          resourceId: 'analytics-sdk-2.1.0'
        },
        recommendation: 'Remove SDK and implement alternative solution',
        detectionDate: getRelativeDate(-2),
        cvssScore: 8.4,
        exploitability: 'EASY'
      }
    ],
    complianceImpact: {
      auditRisk: 'HIGH',
      nextAuditDate: getRelativeDate(30),
      primaryFramework: 'OWASP MASVS',
      controlIds: ['MSTG-CODE-5', 'MSTG-PLATFORM-2'],
      nextSteps: {
        technical: [
          {
            step: 'Remove malicious SDK',
            aiAction: 'Generate removal script'
          },
          {
            step: 'Implement new analytics',
            aiAction: 'Setup analytics config'
          },
          {
            step: 'Update dependencies',
            aiAction: 'Update package files'
          }
        ],
        process: [
          {
            step: 'Review SDK approval process',
            aiAction: 'Create approval flow'
          },
          {
            step: 'Update security scanning',
            aiAction: 'Configure SDK scans'
          }
        ],
        documentation: [
          {
            step: 'Document incident timeline',
            aiAction: 'Generate timeline'
          },
          {
            step: 'Update SDK guidelines',
            aiAction: 'Create SDK guide'
          }
        ],
        timeline: getRelativeDate(1),
        owner: 'Mobile Engineering Team'
      }
    },
    remediationDetails: {
      jiraTicket: {
        id: 'MOB-346',
        url: 'https://acme.atlassian.net/browse/MOB-346',
        status: 'In Progress'
      },
      patchAvailable: true,
      workaroundAvailable: true,
      estimatedEffort: 'HIGH',
      assignedTo: 'Mobile Engineering Team',
      targetFixDate: getRelativeDate(1)
    },
    exposureDetails: {
      exposedAssets: 2,
      affectedAssets: [
        {
          name: 'ios-app',
          resourceType: 'Other',
          details: 'iOS Customer App',
          region: 'global',
          owner: 'Mobile Team',
          team: 'MOBILE ENGINEERING',
          platform: {
            os: 'iOS',
            version: '17.0+',
            type: 'Other'
          }
        },
        {
          name: 'android-app',
          resourceType: 'Other',
          details: 'Android Customer App',
          region: 'global',
          owner: 'Mobile Team',
          team: 'MOBILE ENGINEERING',
          platform: {
            os: 'Android',
            version: '13.0+',
            type: 'Other'
          }
        }
      ],
      exposedData: ['Usage Analytics', 'Device Information', 'User Behavior Data'],
      attackVector: 'Network',
      attackComplexity: 'LOW',
      privilegesRequired: 'NONE',
      userInteraction: 'NONE',
      scope: 'CHANGED',
      confidentialityImpact: 'HIGH',
      integrityImpact: 'LOW',
      availabilityImpact: 'LOW'
    },
    businessImpact: {
      financial: [
        'Emergency app update costs',
        'Analytics system replacement',
        'Security audit expenses',
        'Potential legal liabilities'
      ],
      regulatory: [
        'Privacy regulation violations',
        'App store security compliance',
        'Data protection requirements',
        'Disclosure obligations'
      ],
      operational: [
        'Loss of analytics data',
        'App release required',
        'SDK integration rework',
        'Monitoring implementation'
      ],
      customer: [
        'Forced app updates',
        'Privacy concerns',
        'App performance impact',
        'Trust degradation'
      ]
    }
  }
];
  